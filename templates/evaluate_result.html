{% extends "base.html" %}
{% block title %}Evaluation Results{% endblock %}
{% block content %}
<style>.navbar-brand { color: #198754 !important; }</style>
<div class="container mt-5">
    <div class="card p-4">
        
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 class="text-success mb-0">Evaluation Results</h4>
            <form method="POST" action="/download_zip" class="mb-0">
                <textarea name="main_csv" style="display:none;">{{ main_result_csv }}</textarea>
                <textarea name="full_csv" style="display:none;">{{ full_eval_csv }}</textarea>
                <button class="btn btn-dark btn-sm">Download All</button>
            </form>
        </div>


        {% if main_result %}
        <h5 class="mb-2">Main Result</h5>

        <div class="d-flex justify-content-between mb-2">
            <a href="{{ main_csv_url }}" class="btn btn-outline-primary btn-sm">Download MainResult.csv</a>
            <button class="btn btn-outline-secondary btn-sm" type="button" data-bs-toggle="collapse" data-bs-target="#mainResultTable" aria-expanded="false" aria-controls="mainResultTable">
                Toggle Result
            </button>
        </div>

        <div class="collapse show" id="mainResultTable">
            <div class="table-responsive">
                {{ main_result | safe }}
            </div>
        </div>
        {% endif %}


        <hr class="my-4">

        {% if full_evaluation %}
        <h5 class="mb-2">Full Evaluation Result</h5>
        
        <div class="d-flex justify-content-between mb-2">
            <a href="{{ full_csv_url }}" class="btn btn-outline-primary btn-sm">Download FullEvaluationResult.csv</a>
             <button class="btn btn-outline-secondary btn-sm" type="button" data-bs-toggle="collapse" data-bs-target="#FullEvaluationResult" aria-expanded="false" aria-controls="mainResultTable">
                Toggle Result
            </button>
        </div>

        <div class="collapse show" id="FullEvaluationResult">
            <div class="table-responsive">
                {{ full_evaluation | safe }}
            </div>
        </div>
        {% endif %}

        <hr class="my-4">

        <h5>PDF Report</h5>
        <div class="d-flex justify-content-between align-items-center mb-4">
            <a href="{{ pdf_url }}" class="btn btn-outline-danger btn-sm mb-0">Download PDF</a>
            <a href="{{ pdf_url }}" target="_blank" class="btn btn-sm btn-secondary mb-0">Open Fullscreen</a>
        </div>
        <div class="border rounded shadow-sm p-2" style="height: 800px;">
            <iframe src="{{ pdf_url }}" width="100%" height="100%" style="border: none;"></iframe>
        </div>
        
        <div class="mt-3">
            <a href="/evaluate" class="btn btn-secondary">Back to Evaluate</a>
        </div>

    </div>
</div>
{% endblock %}
